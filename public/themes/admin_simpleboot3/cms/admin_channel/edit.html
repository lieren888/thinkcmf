<include file="public@header" />
</head>

<body>
    <div class="wrap js-check-wrap">
        <ul class="nav nav-tabs">
            <li><a href="{:url('AdminChannel/index')}">分类管理</a></li>
            <li><a href="{:url('AdminChannel/add')}">添加分类</a></li>
            <li class="active"><a>编辑分类</a></li>
        </ul>
        <div style="padding: 10px 15px; background: #e8edf0;">用于管理网站的分类，可进行无限级分类，注意只有类型为列表的才可以添加文章</div>
        <div class="row margin-top-20">
            <div class="col-md-6">
                <form class="js-ajax-form" action="{:url('AdminChannel/editPost')}" method="post">
                    <div class="tab-content">
                        <div class="form-group">
                            <label for="input-type"><span class="form-required">*</span>类型</label>
                            <div>
                                <span style="margin-right: 10px;"><input type="radio" disabled <if
                                        condition="$type=='channel'">checked</if>>栏目</span>
                                <span style="margin-right: 10px;"><input type="radio" disabled <if
                                        condition="$type=='list'">checked</if>>列表</span>
                                <span style="margin-right: 10px;"><input type="radio" disabled <if
                                        condition="$type=='link'">checked</if>>外表链接</span>
                                <input type="hidden" name="type" value="{$type}">
                            </div>
                            <div style="margin-top:10px; background-color: #d9edf7; padding:15px;">
                                <p>
                                    <string>栏目</string>: 栏目类型下不可以发布文章,但可以添加子栏目、列表、链接
                                </p>
                                <p>
                                    <string>列表</string>: 列表类型下可以发布文章,但不能添加子栏目
                                </p>
                                <p>
                                    <string>链接</string>: 链接类型下不可以发布文章和子级栏目
                                </p>
                            </div>
                        </div>
                        <div class="form-group model_id">
                            <label for="input-model_id"><span class="form-required">*</span>模型ID</label>
                            <div>
                                <select class="form-control" name="model_id" id="input-model_id" disabled>
                                    <foreach name="modelxList" item="vo">
                                        <option value="{$vo.id}">{$vo.name}</option>
                                    </foreach>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="input-parent"><span class="form-required">*</span>上级</label>
                            <div>
                                <select class="form-control" name="parent_id" id="input-parent">
                                    <option value="0">作为一级分类</option>
                                    {$channel_tree}
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="input-name"><span class="form-required">*</span>分类名称</label>
                            <div>
                                <input type="text" class="form-control" id="input-name" name="name" value="{$name}">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="input-alias">分类别名</label>
                            <div>
                                <input type="text" class="form-control" id="input-alias" name="alias"
                                    value="{$alias|default=''}">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="input-description">缩略图</label>
                            <div>
                                <input type="hidden" name="more[thumbnail]" class="form-control"
                                    value="{$more.thumbnail|default=''}" id="js-thumbnail-input">
                                <div>
                                    <a href="javascript:uploadOneImage('图片上传','#js-thumbnail-input');">
                                        <if condition="empty($more.thumbnail)">
                                            <img src="__TMPL__/public/assets/images/default-thumbnail.png"
                                                id="js-thumbnail-input-preview" width="135" style="cursor: pointer" />
                                            <else />
                                            <img src="{:cmf_get_image_preview_url($more.thumbnail)}"
                                                id="js-thumbnail-input-preview" width="135" style="cursor: pointer" />
                                        </if>
                                    </a>
                                </div>
                            </div>
                        </div>

                        <div class="form-group type-channel-list">
                            <label for="input-keywords">关键字</label>
                            <div>
                                <input type="text" class="form-control" id="input-keywords" name="keywords"
                                    value="{$keywords}">
                            </div>
                        </div>
                        <div class="form-group type-channel-list">
                            <label for="input-description">描述</label>
                            <div>
                                <textarea class="form-control" name="description"
                                    id="input-description">{$description}</textarea>
                            </div>
                        </div>
                        <div class="form-group type-channel">
                            <label for="input-channeltpl"><span class="form-required">*</span>栏目页模板</label>
                            <div>
                                <select class="form-control" name="channeltpl" id="input-channeltpl">
                                    <!--<option value="list">portal/list.html(默认)</option>-->
                                    <foreach name="channel_theme_files" item="vo">
                                        <php>$value=preg_replace('/^cms\//','',$vo['file']);</php>
                                        <option value="{$value}">{$vo.name} {$vo.file}.html</option>
                                    </foreach>
                                </select>
                            </div>
                        </div>
                        <div class="form-group type-list">
                            <label for="input-listtpl"><span class="form-required">*</span>列表页模板</label>
                            <div>
                                <select class="form-control" name="listtpl" id="input-listtpl">
                                    <!--<option value="list">portal/list.html(默认)</option>-->
                                    <foreach name="list_theme_files" item="vo">
                                        <php>$value=preg_replace('/^cms\//','',$vo['file']);</php>
                                        <option value="{$value}">{$vo.name} {$vo.file}.html</option>
                                    </foreach>
                                </select>
                            </div>
                        </div>
                        <div class="form-group type-list">
                            <label for="input-showtpl"><span class="form-required">*</span>详情页模板</label>
                            <div>
                                <select class="form-control" name="showtpl" id="input-showtpl">
                                    <!--<option value="article">portal/article.html(默认)</option>-->
                                    <foreach name="article_theme_files" item="vo">
                                        <php>$value=preg_replace('/^cms\//','',$vo['file']);</php>
                                        <option value="{$value}">{$vo.name} {$vo.file}.html</option>
                                    </foreach>
                                </select>
                            </div>
                        </div>
                        <div class="form-group type-link">
                            <label for="input-outlink"><span class="form-required">*</span>外部链接</label>
                            <div>
                                <input type="text" class="form-control" id="input-outlink" name="outlink">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <input type="hidden" name="id" value="{$id}">
                        <button type="submit" class="btn btn-primary js-ajax-submit" data-refresh="0">{:lang('SAVE')}
                        </button>
                        <a class="btn btn-default" href="{:url('AdminChannel/index')}">{:lang('BACK')}</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="__STATIC__/js/admin.js"></script>
    <script>
        $('#input-list_tpl').val("{$list_tpl|default=''}");
        $('#input-one_tpl').val("{$one_tpl|default=''}");
    </script>
</body>

<script>
    $(function () {
        //类型单选按钮
        var typeVal = "{$type}";
        init(typeVal);
        function init(typeVal) {
            //栏目
            if (typeVal == 'channel') {
                $('.model_id').show();
                $('.type-list,.type-link').hide();
                $('.type-channel').show();
                $('.type-channel-list').show();
            }
            //列表
            if (typeVal == 'list') {
                $('.model_id').show();
                $('.type-list').show();
                $('.type-channel,.type-link').hide();
                $('.type-channel-list').show();
            }
            //外部链接
            if (typeVal == 'link') {
                $('.model_id').hide();
                $('.type-list').hide();
                $('.type-channel').hide();
                $('.type-channel-list').hide();
                $('.type-link').show();
            }
        }
        $('#input-channeltpl').val("{$channeltpl|default=''}");
        $('#input-listtpl').val("{$listtpl|default=''}");
        $('#input-showtpl').val("{$showtpl|default=''}");
        $('#input-model_id').val("{$model_id|default=''}");
    })
</script>

</html>